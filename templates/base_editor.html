<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Редактор базы планов</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .hla-block, .steps-block {
            border: 1px solid #ccc;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        .form-group {
            margin-bottom: 10px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
        }
        .form-group input {
            width: calc(100% - 30px);
            padding: 8px;
        }
        .add-step {
            display: inline-block;
            margin-left: 10px;
            padding: 8px 12px;
            font-size: 14px;
            cursor: pointer;
            border: 1px solid #ccc;
            background-color: #f9f9f9;
            border-radius: 3px;
        }
        .buttons {
            margin-top: 20px;
        }
        .buttons button {
            padding: 10px 15px;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <h1>Редактор базы планов</h1>
    <form id="hla-form" action="/editor" method="POST">
        <div id="hla-container">
            <div class="hla-block">
                <h3>HLA Action</h3>
                <div class="form-group">
                    <label for="hla_var1_1">Переменная 1</label>
                    <input type="text" name="hla_var1[]" id="hla_var1_1" required>
                </div>
                <div class="form-group">
                    <label for="hla_var2_1">Переменная 2</label>
                    <input type="text" name="hla_var2[]" id="hla_var2_1" required>
                </div>
                <div class="steps-container">
                    <h4>Steps</h4>
                    <div class="steps-block">
                        <div class="form-group">
                            <label for="step_var1_1_1">Шаг - Переменная 1</label>
                            <input type="text" name="step_var1_1[]" id="step_var1_1_1" required>
                        </div>
                        <div class="form-group">
                            <label for="step_var2_1_1">Шаг - Переменная 2</label>
                            <input type="text" name="step_var2_1[]" id="step_var2_1_1" required>
                        </div>
                        <button type="button" class="add-step" data-hla="1">+</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="buttons">
            <button type="button" id="add-more-hla">Добавить ещё</button>
            <button type="submit">Завершить и сохранить</button>
        </div>
    </form>

    <script>
        let hlaCount = 1;

        // Добавление нового блока HLA
        document.getElementById('add-more-hla').addEventListener('click', function () {
            hlaCount++;
            const hlaContainer = document.getElementById('hla-container');

            const hlaBlock = document.createElement('div');
            hlaBlock.classList.add('hla-block');
            hlaBlock.innerHTML = `
                <h3>HLA Action</h3>
                <div class="form-group">
                    <label for="hla_var1_${hlaCount}">Переменная 1</label>
                    <input type="text" name="hla_var1[]" id="hla_var1_${hlaCount}" required>
                </div>
                <div class="form-group">
                    <label for="hla_var2_${hlaCount}">Переменная 2</label>
                    <input type="text" name="hla_var2[]" id="hla_var2_${hlaCount}" required>
                </div>
                <div class="steps-container">
                    <h4>Steps</h4>
                    <div class="steps-block">
                        <div class="form-group">
                            <label for="step_var1_${hlaCount}_1">Шаг - Переменная 1</label>
                            <input type="text" name="step_var1_${hlaCount}[]" id="step_var1_${hlaCount}_1" required>
                        </div>
                        <div class="form-group">
                            <label for="step_var2_${hlaCount}_1">Шаг - Переменная 2</label>
                            <input type="text" name="step_var2_${hlaCount}[]" id="step_var2_${hlaCount}_1" required>
                        </div>
                        <button type="button" class="add-step" data-hla="${hlaCount}">+</button>
                    </div>
                </div>
            `;
            hlaContainer.appendChild(hlaBlock);
        });

        // Добавление новых пар для Steps
        document.addEventListener('click', function (event) {
            if (event.target.classList.contains('add-step')) {
                const hlaIndex = event.target.dataset.hla;
                const stepsBlock = document.createElement('div');
                stepsBlock.classList.add('form-group');
                const stepCount = document.querySelectorAll(`[data-hla="${hlaIndex}"]`).length + 1;

                stepsBlock.innerHTML = `
                    <div class="form-group">
                        <label for="step_var1_${hlaIndex}_${stepCount}">Шаг - Переменная 1</label>
                        <input type="text" name="step_var1_${hlaIndex}[]" id="step_var1_${hlaIndex}_${stepCount}" required>
                    </div>
                    <div class="form-group">
                        <label for="step_var2_${hlaIndex}_${stepCount}">Шаг - Переменная 2</label>
                        <input type="text" name="step_var2_${hlaIndex}[]" id="step_var2_${hlaIndex}_${stepCount}" required>
                    </div>
                `;
                event.target.parentNode.insertBefore(stepsBlock, event.target);
            }
        });
    </script>
</body>
</html>